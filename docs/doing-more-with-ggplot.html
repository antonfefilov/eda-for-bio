<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>APS 135: Introduction to Exploratory Data Analysis with R</title>
  <meta name="description" content="Course book for Introduction to Exploratory Data Analysis with R (APS 135) in the Department of Animal and Plant Sciences, University of Sheffield.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="APS 135: Introduction to Exploratory Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course book for Introduction to Exploratory Data Analysis with R (APS 135) in the Department of Animal and Plant Sciences, University of Sheffield." />
  <meta name="github-repo" content="dzchilds/eda-for-bio" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="APS 135: Introduction to Exploratory Data Analysis with R" />
  
  <meta name="twitter:description" content="Course book for Introduction to Exploratory Data Analysis with R (APS 135) in the Department of Animal and Plant Sciences, University of Sheffield." />
  

<meta name="author" content="Dylan Z. Childs">


<meta name="date" content="2018-02-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="building-in-complexity.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<style type="text/css">

.action, .warning, .info, .speed {
  padding: 1em 1em 1em 4em;
  margin-bottom: 10px;
  background: #f5f5f5 5px center/3em no-repeat;
}
.action {
  background-image: url("./images/action.png");
}
.warning {
  background-image: url("./images/warning.png");
}
.info {
  background-image: url("./images/info.png");
}
.speed {
  background-image: url("./images/speed.png");
}


</style>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">APS 135 (R course)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Information and overview</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#aims"><i class="fa fa-check"></i>Aims</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#topics"><i class="fa fa-check"></i>Topics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-the-book"><i class="fa fa-check"></i>How to use the book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i>Getting help</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#updates"><i class="fa fa-check"></i>Updates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get-up-and-running-with-r-and-rstudio.html"><a href="get-up-and-running-with-r-and-rstudio.html"><i class="fa fa-check"></i>Get up and running with R and RStudio</a><ul>
<li class="chapter" data-level="" data-path="get-up-and-running-with-r-and-rstudio.html"><a href="get-up-and-running-with-r-and-rstudio.html#what-is-r"><i class="fa fa-check"></i>What is R?</a><ul>
<li class="chapter" data-level="" data-path="get-up-and-running-with-r-and-rstudio.html"><a href="get-up-and-running-with-r-and-rstudio.html#getting-and-installing-r"><i class="fa fa-check"></i>Getting and installing R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get-up-and-running-with-r-and-rstudio.html"><a href="get-up-and-running-with-r-and-rstudio.html#what-is-rstudio-and-why-use-it"><i class="fa fa-check"></i>What is RStudio (and why use it)?</a><ul>
<li class="chapter" data-level="" data-path="get-up-and-running-with-r-and-rstudio.html"><a href="get-up-and-running-with-r-and-rstudio.html#getting-and-installing-rstudio"><i class="fa fa-check"></i>Getting and installing RStudio</a></li>
<li class="chapter" data-level="" data-path="get-up-and-running-with-r-and-rstudio.html"><a href="get-up-and-running-with-r-and-rstudio.html#the-anatomy-of-rstudio"><i class="fa fa-check"></i>The anatomy of RStudio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="get-up-and-running-with-r-and-rstudio.html"><a href="get-up-and-running-with-r-and-rstudio.html#working-at-the-console"><i class="fa fa-check"></i>Working at the Console</a></li>
</ul></li>
<li class="part"><span><b>I Introduction to R</b></span></li>
<li class="chapter" data-level="1" data-path="a-quick-introduction-to-r.html"><a href="a-quick-introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> A quick introduction to R</a><ul>
<li class="chapter" data-level="1.1" data-path="a-quick-introduction-to-r.html"><a href="a-quick-introduction-to-r.html#r-calculator"><i class="fa fa-check"></i><b>1.1</b> Using R as a big calculator</a><ul>
<li class="chapter" data-level="1.1.1" data-path="a-quick-introduction-to-r.html"><a href="a-quick-introduction-to-r.html#basic-arithmetic"><i class="fa fa-check"></i><b>1.1.1</b> Basic arithmetic</a></li>
<li class="chapter" data-level="1.1.2" data-path="a-quick-introduction-to-r.html"><a href="a-quick-introduction-to-r.html#problematic-calculations"><i class="fa fa-check"></i><b>1.1.2</b> Problematic calculations</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="a-quick-introduction-to-r.html"><a href="a-quick-introduction-to-r.html#assignment"><i class="fa fa-check"></i><b>1.2</b> Storing and reusing results</a></li>
<li class="chapter" data-level="1.3" data-path="a-quick-introduction-to-r.html"><a href="a-quick-introduction-to-r.html#how-does-assignment-work"><i class="fa fa-check"></i><b>1.3</b> How does assignment work?</a></li>
<li class="chapter" data-level="1.4" data-path="a-quick-introduction-to-r.html"><a href="a-quick-introduction-to-r.html#global-environment"><i class="fa fa-check"></i><b>1.4</b> Global environment</a></li>
<li class="chapter" data-level="1.5" data-path="a-quick-introduction-to-r.html"><a href="a-quick-introduction-to-r.html#naming-rules-and-conventions"><i class="fa fa-check"></i><b>1.5</b> Naming rules and conventions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="scripts.html"><a href="scripts.html"><i class="fa fa-check"></i><b>2</b> Building scripts</a><ul>
<li class="chapter" data-level="2.1" data-path="scripts.html"><a href="scripts.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="scripts.html"><a href="scripts.html#writing-scripts-in-rstudio"><i class="fa fa-check"></i><b>2.2</b> Writing scripts in RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="scripts.html"><a href="scripts.html#running-scripts-in-rstudio"><i class="fa fa-check"></i><b>2.3</b> Running scripts in RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="scripts.html"><a href="scripts.html#spotting-problems"><i class="fa fa-check"></i><b>2.4</b> Spotting problems</a><ul>
<li class="chapter" data-level="2.4.1" data-path="scripts.html"><a href="scripts.html#the-dreaded"><i class="fa fa-check"></i><b>2.4.1</b> The dreaded <code>+</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="scripts.html"><a href="scripts.html#errors"><i class="fa fa-check"></i><b>2.4.2</b> Errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="using-functions.html"><a href="using-functions.html"><i class="fa fa-check"></i><b>3</b> Using functions</a><ul>
<li class="chapter" data-level="3.1" data-path="using-functions.html"><a href="using-functions.html#intro-functions"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="using-functions.html"><a href="using-functions.html#functions-and-arguments"><i class="fa fa-check"></i><b>3.2</b> Functions and arguments</a></li>
<li class="chapter" data-level="3.3" data-path="using-functions.html"><a href="using-functions.html#evaluating-arguments-and-returning-results"><i class="fa fa-check"></i><b>3.3</b> Evaluating arguments and returning results</a></li>
<li class="chapter" data-level="3.4" data-path="using-functions.html"><a href="using-functions.html#functions-do-not-have-side-effects"><i class="fa fa-check"></i><b>3.4</b> Functions do not have “side effects”</a></li>
<li class="chapter" data-level="3.5" data-path="using-functions.html"><a href="using-functions.html#combining-functions"><i class="fa fa-check"></i><b>3.5</b> Combining functions</a></li>
<li class="chapter" data-level="3.6" data-path="using-functions.html"><a href="using-functions.html#function-arguments"><i class="fa fa-check"></i><b>3.6</b> Specifying function arguments</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="numeric-vectors.html"><a href="numeric-vectors.html"><i class="fa fa-check"></i><b>4</b> Numeric vectors</a><ul>
<li class="chapter" data-level="4.1" data-path="numeric-vectors.html"><a href="numeric-vectors.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="numeric-vectors.html"><a href="numeric-vectors.html#atomic-vectors"><i class="fa fa-check"></i><b>4.2</b> Atomic vectors</a></li>
<li class="chapter" data-level="4.3" data-path="numeric-vectors.html"><a href="numeric-vectors.html#intro-vectors"><i class="fa fa-check"></i><b>4.3</b> Numeric vectors</a></li>
<li class="chapter" data-level="4.4" data-path="numeric-vectors.html"><a href="numeric-vectors.html#constructing-numeric-vectors"><i class="fa fa-check"></i><b>4.4</b> Constructing numeric vectors</a></li>
<li class="chapter" data-level="4.5" data-path="numeric-vectors.html"><a href="numeric-vectors.html#named-vectors"><i class="fa fa-check"></i><b>4.5</b> Named vectors</a></li>
<li class="chapter" data-level="4.6" data-path="numeric-vectors.html"><a href="numeric-vectors.html#generating-sequences-of-numbers"><i class="fa fa-check"></i><b>4.6</b> Generating sequences of numbers</a><ul>
<li class="chapter" data-level="4.6.1" data-path="numeric-vectors.html"><a href="numeric-vectors.html#generating-sequences-of-numbers-1"><i class="fa fa-check"></i><b>4.6.1</b> Generating sequences of numbers</a></li>
<li class="chapter" data-level="4.6.2" data-path="numeric-vectors.html"><a href="numeric-vectors.html#generating-repeated-sequences-of-numbers"><i class="fa fa-check"></i><b>4.6.2</b> Generating repeated sequences of numbers</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="numeric-vectors.html"><a href="numeric-vectors.html#vectorised-operations"><i class="fa fa-check"></i><b>4.7</b> Vectorised operations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="other-kinds-of-vectors.html"><a href="other-kinds-of-vectors.html"><i class="fa fa-check"></i><b>5</b> Other kinds of vectors</a><ul>
<li class="chapter" data-level="5.1" data-path="other-kinds-of-vectors.html"><a href="other-kinds-of-vectors.html#other-vectors"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="other-kinds-of-vectors.html"><a href="other-kinds-of-vectors.html#character-vectors"><i class="fa fa-check"></i><b>5.2</b> Character vectors</a></li>
<li class="chapter" data-level="5.3" data-path="other-kinds-of-vectors.html"><a href="other-kinds-of-vectors.html#logical-vectors"><i class="fa fa-check"></i><b>5.3</b> Logical vectors</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="extracting-subsets-of-vectors.html"><a href="extracting-subsets-of-vectors.html"><i class="fa fa-check"></i><b>6</b> Extracting subsets of vectors</a><ul>
<li class="chapter" data-level="6.1" data-path="other-kinds-of-vectors.html"><a href="other-kinds-of-vectors.html#other-vectors"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="extracting-subsets-of-vectors.html"><a href="extracting-subsets-of-vectors.html#subsetting-by-position"><i class="fa fa-check"></i><b>6.2</b> Subsetting by position</a></li>
<li class="chapter" data-level="6.3" data-path="extracting-subsets-of-vectors.html"><a href="extracting-subsets-of-vectors.html#subsetting-with-logical-operators"><i class="fa fa-check"></i><b>6.3</b> Subsetting with logical operators</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="getting-help-1.html"><a href="getting-help-1.html"><i class="fa fa-check"></i><b>7</b> Getting help</a><ul>
<li class="chapter" data-level="7.1" data-path="getting-help-1.html"><a href="getting-help-1.html#console-help"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="getting-help-1.html"><a href="getting-help-1.html#browsing-the-help-system"><i class="fa fa-check"></i><b>7.2</b> Browsing the help system</a></li>
<li class="chapter" data-level="7.3" data-path="getting-help-1.html"><a href="getting-help-1.html#searching-for-help-files"><i class="fa fa-check"></i><b>7.3</b> Searching for help files</a></li>
<li class="chapter" data-level="7.4" data-path="getting-help-1.html"><a href="getting-help-1.html#nav-help"><i class="fa fa-check"></i><b>7.4</b> Navigating help files</a></li>
<li class="chapter" data-level="7.5" data-path="getting-help-1.html"><a href="getting-help-1.html#vignettes"><i class="fa fa-check"></i><b>7.5</b> Vignettes and demos</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>8</b> Packages</a><ul>
<li class="chapter" data-level="8.1" data-path="packages.html"><a href="packages.html#package-system"><i class="fa fa-check"></i><b>8.1</b> The R package system</a></li>
<li class="chapter" data-level="8.2" data-path="packages.html"><a href="packages.html#task-views"><i class="fa fa-check"></i><b>8.2</b> Task views</a></li>
<li class="chapter" data-level="8.3" data-path="packages.html"><a href="packages.html#use-packages"><i class="fa fa-check"></i><b>8.3</b> Using packages</a><ul>
<li class="chapter" data-level="8.3.1" data-path="packages.html"><a href="packages.html#viewing-installed-packages"><i class="fa fa-check"></i><b>8.3.1</b> Viewing installed packages</a></li>
<li class="chapter" data-level="8.3.2" data-path="packages.html"><a href="packages.html#installing-packages"><i class="fa fa-check"></i><b>8.3.2</b> Installing packages</a></li>
<li class="chapter" data-level="8.3.3" data-path="packages.html"><a href="packages.html#loading-and-attaching-packages"><i class="fa fa-check"></i><b>8.3.3</b> Loading and attaching packages</a></li>
<li class="chapter" data-level="8.3.4" data-path="packages.html"><a href="packages.html#an-analogy"><i class="fa fa-check"></i><b>8.3.4</b> An analogy</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data Wrangling</b></span></li>
<li class="chapter" data-level="9" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>9</b> Data frames</a><ul>
<li class="chapter" data-level="9.1" data-path="data-frames.html"><a href="data-frames.html#introduction-2"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="data-frames.html"><a href="data-frames.html#data-frames-intro"><i class="fa fa-check"></i><b>9.2</b> Data frames</a></li>
<li class="chapter" data-level="9.3" data-path="data-frames.html"><a href="data-frames.html#exploring-data-frames"><i class="fa fa-check"></i><b>9.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="9.4" data-path="data-frames.html"><a href="data-frames.html#extract-data"><i class="fa fa-check"></i><b>9.4</b> Extracting data from data frames</a><ul>
<li class="chapter" data-level="9.4.1" data-path="data-frames.html"><a href="data-frames.html#extracting-and-adding-a-single-variable"><i class="fa fa-check"></i><b>9.4.1</b> Extracting and adding a single variable</a></li>
<li class="chapter" data-level="9.4.2" data-path="data-frames.html"><a href="data-frames.html#adding-a-variable-to-a-data-frame"><i class="fa fa-check"></i><b>9.4.2</b> Adding a variable to a data frame</a></li>
<li class="chapter" data-level="9.4.3" data-path="data-frames.html"><a href="data-frames.html#subsetting-data-frames"><i class="fa fa-check"></i><b>9.4.3</b> Subsetting data frames</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="data-frames.html"><a href="data-frames.html#final-words"><i class="fa fa-check"></i><b>9.5</b> Final words</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="working-directories-and-data-files.html"><a href="working-directories-and-data-files.html"><i class="fa fa-check"></i><b>10</b> Working directories and data files</a><ul>
<li class="chapter" data-level="10.1" data-path="working-directories-and-data-files.html"><a href="working-directories-and-data-files.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="working-directories-and-data-files.html"><a href="working-directories-and-data-files.html#data-files-the-csv-format"><i class="fa fa-check"></i><b>10.2</b> Data files: the CSV format</a><ul>
<li class="chapter" data-level="10.2.1" data-path="working-directories-and-data-files.html"><a href="working-directories-and-data-files.html#exporting-csv-files-from-excel"><i class="fa fa-check"></i><b>10.2.1</b> Exporting CSV files from Excel</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="working-directories-and-data-files.html"><a href="working-directories-and-data-files.html#the-working-directory"><i class="fa fa-check"></i><b>10.3</b> The working directory</a></li>
<li class="chapter" data-level="10.4" data-path="working-directories-and-data-files.html"><a href="working-directories-and-data-files.html#importing-data-with-read.csv"><i class="fa fa-check"></i><b>10.4</b> Importing data with <code>read.csv</code></a></li>
<li class="chapter" data-level="10.5" data-path="working-directories-and-data-files.html"><a href="working-directories-and-data-files.html#importing-data-with-rstudio-avoid-this"><i class="fa fa-check"></i><b>10.5</b> Importing data with RStudio (Avoid this!)</a></li>
<li class="chapter" data-level="10.6" data-path="working-directories-and-data-files.html"><a href="working-directories-and-data-files.html#package-data"><i class="fa fa-check"></i><b>10.6</b> Package data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dplyr-and-the-tidy-data-concept.html"><a href="dplyr-and-the-tidy-data-concept.html"><i class="fa fa-check"></i><b>11</b> <strong>dplyr</strong> and the tidy data concept</a><ul>
<li class="chapter" data-level="11.1" data-path="dplyr-and-the-tidy-data-concept.html"><a href="dplyr-and-the-tidy-data-concept.html#introduction-4"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="dplyr-and-the-tidy-data-concept.html"><a href="dplyr-and-the-tidy-data-concept.html#why-dplyr"><i class="fa fa-check"></i><b>11.2</b> The value of <strong>dplyr</strong></a></li>
<li class="chapter" data-level="11.3" data-path="dplyr-and-the-tidy-data-concept.html"><a href="dplyr-and-the-tidy-data-concept.html#tidy-data"><i class="fa fa-check"></i><b>11.3</b> Tidy data</a></li>
<li class="chapter" data-level="11.4" data-path="dplyr-and-the-tidy-data-concept.html"><a href="dplyr-and-the-tidy-data-concept.html#more-dplyr"><i class="fa fa-check"></i><b>11.4</b> A quick look at <strong>dplyr</strong></a><ul>
<li class="chapter" data-level="11.4.1" data-path="dplyr-and-the-tidy-data-concept.html"><a href="dplyr-and-the-tidy-data-concept.html#tibble-tbl-objects"><i class="fa fa-check"></i><b>11.4.1</b> Tibble (<code>tbl</code>) objects</a></li>
<li class="chapter" data-level="11.4.2" data-path="dplyr-and-the-tidy-data-concept.html"><a href="dplyr-and-the-tidy-data-concept.html#the-glimpse-function"><i class="fa fa-check"></i><b>11.4.2</b> The <code>glimpse</code> function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="working-with-variables.html"><a href="working-with-variables.html"><i class="fa fa-check"></i><b>12</b> Working with variables</a><ul>
<li class="chapter" data-level="12.1" data-path="working-with-variables.html"><a href="working-with-variables.html#introduction-5"><i class="fa fa-check"></i><b>12.1</b> Introduction</a><ul>
<li class="chapter" data-level="12.1.1" data-path="working-with-variables.html"><a href="working-with-variables.html#getting-ready"><i class="fa fa-check"></i><b>12.1.1</b> Getting ready</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="working-with-variables.html"><a href="working-with-variables.html#subset-variables-with-select"><i class="fa fa-check"></i><b>12.2</b> Subset variables with <code>select</code></a><ul>
<li class="chapter" data-level="12.2.1" data-path="working-with-variables.html"><a href="working-with-variables.html#renaming-variables-with-select-and-rename"><i class="fa fa-check"></i><b>12.2.1</b> Renaming variables with <code>select</code> and <code>rename</code></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="working-with-variables.html"><a href="working-with-variables.html#creating-variables-with-mutate"><i class="fa fa-check"></i><b>12.3</b> Creating variables with <code>mutate</code></a><ul>
<li class="chapter" data-level="12.3.1" data-path="working-with-variables.html"><a href="working-with-variables.html#transforming-and-dropping-variables"><i class="fa fa-check"></i><b>12.3.1</b> Transforming and dropping variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="working-with-observations.html"><a href="working-with-observations.html"><i class="fa fa-check"></i><b>13</b> Working with observations</a><ul>
<li class="chapter" data-level="13.1" data-path="working-with-observations.html"><a href="working-with-observations.html#introduction-6"><i class="fa fa-check"></i><b>13.1</b> Introduction</a><ul>
<li class="chapter" data-level="13.1.1" data-path="working-with-observations.html"><a href="working-with-observations.html#getting-ready-1"><i class="fa fa-check"></i><b>13.1.1</b> Getting ready</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="working-with-observations.html"><a href="working-with-observations.html#subset-observations-with-filter"><i class="fa fa-check"></i><b>13.2</b> Subset observations with <code>filter</code></a></li>
<li class="chapter" data-level="13.3" data-path="working-with-observations.html"><a href="working-with-observations.html#reording-observations-with-arrange"><i class="fa fa-check"></i><b>13.3</b> Reording observations with <code>arrange</code></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="helper-functions.html"><a href="helper-functions.html"><i class="fa fa-check"></i><b>14</b> Helper functions</a><ul>
<li class="chapter" data-level="14.1" data-path="helper-functions.html"><a href="helper-functions.html#introduction-7"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="helper-functions.html"><a href="helper-functions.html#working-with-select"><i class="fa fa-check"></i><b>14.2</b> Working with <code>select</code></a></li>
<li class="chapter" data-level="14.3" data-path="helper-functions.html"><a href="helper-functions.html#working-with-mutate-and-transmute"><i class="fa fa-check"></i><b>14.3</b> Working with <code>mutate</code> and <code>transmute</code></a></li>
<li class="chapter" data-level="14.4" data-path="helper-functions.html"><a href="helper-functions.html#working-with-filter"><i class="fa fa-check"></i><b>14.4</b> Working with <code>filter</code></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="grouping-and-summarising-data.html"><a href="grouping-and-summarising-data.html"><i class="fa fa-check"></i><b>15</b> Grouping and summarising data</a><ul>
<li class="chapter" data-level="15.0.1" data-path="grouping-and-summarising-data.html"><a href="grouping-and-summarising-data.html#getting-ready-2"><i class="fa fa-check"></i><b>15.0.1</b> Getting ready</a></li>
<li class="chapter" data-level="15.1" data-path="grouping-and-summarising-data.html"><a href="grouping-and-summarising-data.html#summarising-variables-with-summarise"><i class="fa fa-check"></i><b>15.1</b> Summarising variables with <code>summarise</code></a><ul>
<li class="chapter" data-level="15.1.1" data-path="grouping-and-summarising-data.html"><a href="grouping-and-summarising-data.html#helper-functions-1"><i class="fa fa-check"></i><b>15.1.1</b> Helper functions</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="grouping-and-summarising-data.html"><a href="grouping-and-summarising-data.html#grouped-operations-using-group_by"><i class="fa fa-check"></i><b>15.2</b> Grouped operations using <code>group_by</code></a><ul>
<li class="chapter" data-level="15.2.1" data-path="grouping-and-summarising-data.html"><a href="grouping-and-summarising-data.html#more-than-one-grouping-variable"><i class="fa fa-check"></i><b>15.2.1</b> More than one grouping variable</a></li>
<li class="chapter" data-level="15.2.2" data-path="grouping-and-summarising-data.html"><a href="grouping-and-summarising-data.html#using-group_by-with-other-verbs"><i class="fa fa-check"></i><b>15.2.2</b> Using <code>group_by</code> with other verbs</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="grouping-and-summarising-data.html"><a href="grouping-and-summarising-data.html#removing-grouping-information"><i class="fa fa-check"></i><b>15.3</b> Removing grouping information</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="building-pipelines.html"><a href="building-pipelines.html"><i class="fa fa-check"></i><b>16</b> Building pipelines</a><ul>
<li class="chapter" data-level="16.1" data-path="building-pipelines.html"><a href="building-pipelines.html#why-do-we-need-pipes"><i class="fa fa-check"></i><b>16.1</b> Why do we need ‘pipes’?</a></li>
</ul></li>
<li class="part"><span><b>III Exporing Data</b></span></li>
<li class="chapter" data-level="17" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>17</b> Exploratory data analysis</a><ul>
<li class="chapter" data-level="17.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-8"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#variables"><i class="fa fa-check"></i><b>17.2</b> Statistical variables and data</a><ul>
<li class="chapter" data-level="17.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#numeric-vs.categorical-variables"><i class="fa fa-check"></i><b>17.2.1</b> Numeric vs. categorical variables</a></li>
<li class="chapter" data-level="17.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#ratio-vs.interval-scales"><i class="fa fa-check"></i><b>17.2.2</b> Ratio vs. interval scales</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#populations-samples"><i class="fa fa-check"></i><b>17.3</b> Populations, samples and distributions</a></li>
<li class="chapter" data-level="17.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#relationships"><i class="fa fa-check"></i><b>17.4</b> Relationships</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html"><i class="fa fa-check"></i><b>18</b> Introduction to <strong>ggplot2</strong></a><ul>
<li class="chapter" data-level="18.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#anatomy"><i class="fa fa-check"></i><b>18.1</b> The anatomy of ggplot2</a><ul>
<li class="chapter" data-level="18.1.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#layers"><i class="fa fa-check"></i><b>18.1.1</b> Layers</a></li>
<li class="chapter" data-level="18.1.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#scales"><i class="fa fa-check"></i><b>18.1.2</b> Scales</a></li>
<li class="chapter" data-level="18.1.3" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#coordinate-system"><i class="fa fa-check"></i><b>18.1.3</b> Coordinate system</a></li>
<li class="chapter" data-level="18.1.4" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#faceting"><i class="fa fa-check"></i><b>18.1.4</b> Faceting</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#quick"><i class="fa fa-check"></i><b>18.2</b> A quick introduction to ggplot2</a><ul>
<li class="chapter" data-level="18.2.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#making-a-start"><i class="fa fa-check"></i><b>18.2.1</b> Making a start</a></li>
<li class="chapter" data-level="18.2.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#the-standard-way-of-using-ggplot2"><i class="fa fa-check"></i><b>18.2.2</b> The standard way of using <strong>ggplot2</strong></a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#increasing-the-information-density"><i class="fa fa-check"></i><b>18.3</b> Increasing the information density</a><ul>
<li class="chapter" data-level="18.3.1" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#using-additional-aesthetics"><i class="fa fa-check"></i><b>18.3.1</b> Using additional aesthetics</a></li>
<li class="chapter" data-level="18.3.2" data-path="introduction-to-ggplot2.html"><a href="introduction-to-ggplot2.html#using-facets"><i class="fa fa-check"></i><b>18.3.2</b> Using facets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="customising-plots.html"><a href="customising-plots.html"><i class="fa fa-check"></i><b>19</b> Customising plots</a><ul>
<li class="chapter" data-level="19.1" data-path="customising-plots.html"><a href="customising-plots.html#working-with-layer-specific-geom-properties"><i class="fa fa-check"></i><b>19.1</b> Working with layer specific geom properties</a><ul>
<li class="chapter" data-level="19.1.1" data-path="customising-plots.html"><a href="customising-plots.html#the-relationship-between-aesthetics-and-geom-properties."><i class="fa fa-check"></i><b>19.1.1</b> The relationship between aesthetics and geom properties.</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="customising-plots.html"><a href="customising-plots.html#working-with-layer-specific-position-adjustments"><i class="fa fa-check"></i><b>19.2</b> Working with layer specific position adjustments</a></li>
<li class="chapter" data-level="19.3" data-path="customising-plots.html"><a href="customising-plots.html#working-with-plot-specific-scales"><i class="fa fa-check"></i><b>19.3</b> Working with plot specific scales</a></li>
<li class="chapter" data-level="19.4" data-path="customising-plots.html"><a href="customising-plots.html#adding-titles-and-labels"><i class="fa fa-check"></i><b>19.4</b> Adding titles and labels</a></li>
<li class="chapter" data-level="19.5" data-path="customising-plots.html"><a href="customising-plots.html#themes"><i class="fa fa-check"></i><b>19.5</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="exploring-one-numeric-variable.html"><a href="exploring-one-numeric-variable.html"><i class="fa fa-check"></i><b>20</b> Exploring one numeric variable</a><ul>
<li class="chapter" data-level="20.1" data-path="exploring-one-numeric-variable.html"><a href="exploring-one-numeric-variable.html#explore-numeric"><i class="fa fa-check"></i><b>20.1</b> Understanding numerical variables</a></li>
<li class="chapter" data-level="20.2" data-path="exploring-one-numeric-variable.html"><a href="exploring-one-numeric-variable.html#graphical-summaries"><i class="fa fa-check"></i><b>20.2</b> Graphical summaries</a></li>
<li class="chapter" data-level="20.3" data-path="exploring-one-numeric-variable.html"><a href="exploring-one-numeric-variable.html#descriptive-statistics"><i class="fa fa-check"></i><b>20.3</b> Descriptive statistics</a><ul>
<li class="chapter" data-level="20.3.1" data-path="exploring-one-numeric-variable.html"><a href="exploring-one-numeric-variable.html#measuring-central-tendency"><i class="fa fa-check"></i><b>20.3.1</b> Measuring central tendency</a></li>
<li class="chapter" data-level="20.3.2" data-path="exploring-one-numeric-variable.html"><a href="exploring-one-numeric-variable.html#measuring-dispersion"><i class="fa fa-check"></i><b>20.3.2</b> Measuring dispersion</a></li>
<li class="chapter" data-level="20.3.3" data-path="exploring-one-numeric-variable.html"><a href="exploring-one-numeric-variable.html#skewness"><i class="fa fa-check"></i><b>20.3.3</b> Skewness</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="exploring-categorical-variables.html"><a href="exploring-categorical-variables.html"><i class="fa fa-check"></i><b>21</b> Exploring categorical variables</a><ul>
<li class="chapter" data-level="21.1" data-path="exploring-categorical-variables.html"><a href="exploring-categorical-variables.html#explore-categorical"><i class="fa fa-check"></i><b>21.1</b> Understanding categorical variables</a><ul>
<li class="chapter" data-level="21.1.1" data-path="exploring-categorical-variables.html"><a href="exploring-categorical-variables.html#numerical-summaries"><i class="fa fa-check"></i><b>21.1.1</b> Numerical summaries</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="exploring-categorical-variables.html"><a href="exploring-categorical-variables.html#graphical-summaries-of-categorical-variables"><i class="fa fa-check"></i><b>21.2</b> Graphical summaries of categorical variables</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="relationships-between-two-variables.html"><a href="relationships-between-two-variables.html"><i class="fa fa-check"></i><b>22</b> Relationships between two variables</a><ul>
<li class="chapter" data-level="22.1" data-path="relationships-between-two-variables.html"><a href="relationships-between-two-variables.html#numeric"><i class="fa fa-check"></i><b>22.1</b> Associations between numeric variables</a><ul>
<li class="chapter" data-level="22.1.1" data-path="relationships-between-two-variables.html"><a href="relationships-between-two-variables.html#descriptive-statistics-1"><i class="fa fa-check"></i><b>22.1.1</b> Descriptive statistics</a></li>
<li class="chapter" data-level="22.1.2" data-path="relationships-between-two-variables.html"><a href="relationships-between-two-variables.html#graphical-summaries-1"><i class="fa fa-check"></i><b>22.1.2</b> Graphical summaries</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="relationships-between-two-variables.html"><a href="relationships-between-two-variables.html#categorical"><i class="fa fa-check"></i><b>22.2</b> Associations between categorical variables</a><ul>
<li class="chapter" data-level="22.2.1" data-path="relationships-between-two-variables.html"><a href="relationships-between-two-variables.html#numerical-summaries-1"><i class="fa fa-check"></i><b>22.2.1</b> Numerical summaries</a></li>
<li class="chapter" data-level="22.2.2" data-path="relationships-between-two-variables.html"><a href="relationships-between-two-variables.html#graphical-summaries-2"><i class="fa fa-check"></i><b>22.2.2</b> Graphical summaries</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="relationships-between-two-variables.html"><a href="relationships-between-two-variables.html#categorical"><i class="fa fa-check"></i><b>22.3</b> Categorical-numerical associations</a><ul>
<li class="chapter" data-level="22.3.1" data-path="relationships-between-two-variables.html"><a href="relationships-between-two-variables.html#descriptive-statistics-2"><i class="fa fa-check"></i><b>22.3.1</b> Descriptive statistics</a></li>
<li class="chapter" data-level="22.3.2" data-path="relationships-between-two-variables.html"><a href="relationships-between-two-variables.html#graphical-summaries-3"><i class="fa fa-check"></i><b>22.3.2</b> Graphical summaries</a></li>
<li class="chapter" data-level="22.3.3" data-path="relationships-between-two-variables.html"><a href="relationships-between-two-variables.html#alternatives-to-box-and-whiskers-plots"><i class="fa fa-check"></i><b>22.3.3</b> Alternatives to box and whiskers plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="building-in-complexity.html"><a href="building-in-complexity.html"><i class="fa fa-check"></i><b>23</b> Building in complexity</a><ul>
<li class="chapter" data-level="23.1" data-path="building-in-complexity.html"><a href="building-in-complexity.html#multivariate"><i class="fa fa-check"></i><b>23.1</b> Multivariate relationships</a></li>
<li class="chapter" data-level="23.2" data-path="building-in-complexity.html"><a href="building-in-complexity.html#summaries"><i class="fa fa-check"></i><b>23.2</b> Comparing descriptive statistics</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="doing-more-with-ggplot.html"><a href="doing-more-with-ggplot.html"><i class="fa fa-check"></i><b>24</b> Doing more with ggplot</a><ul>
<li class="chapter" data-level="24.1" data-path="doing-more-with-ggplot.html"><a href="doing-more-with-ggplot.html#adding-error-bars"><i class="fa fa-check"></i><b>24.1</b> Adding error bars</a></li>
<li class="chapter" data-level="24.2" data-path="doing-more-with-ggplot.html"><a href="doing-more-with-ggplot.html#adding-text-to-plots"><i class="fa fa-check"></i><b>24.2</b> Adding text to plots</a></li>
<li class="chapter" data-level="24.3" data-path="doing-more-with-ggplot.html"><a href="doing-more-with-ggplot.html#customising-text"><i class="fa fa-check"></i><b>24.3</b> Customising text</a></li>
<li class="chapter" data-level="24.4" data-path="doing-more-with-ggplot.html"><a href="doing-more-with-ggplot.html#saving-plots"><i class="fa fa-check"></i><b>24.4</b> Saving plots</a></li>
<li class="chapter" data-level="24.5" data-path="doing-more-with-ggplot.html"><a href="doing-more-with-ggplot.html#panel-plots"><i class="fa fa-check"></i><b>24.5</b> Panel plots</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">APS 135: Introduction to Exploratory Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="doing-more-with-ggplot" class="section level1">
<h1><span class="header-section-number">Chapter 24</span> Doing more with ggplot</h1>
<p>Throughout this block we have learnt a range of ways to plot our data using <strong>ggplot2</strong>. Here we provide a few more examples of ways you may wish to customise your plots. You will not be examined on the material in this chapter, however it will be helpful when you have to make plots for other modules, such as during your Level 1 projects.</p>
<p>We will use the <code>storms</code> data set again from the <strong>nasaweather</strong> package. As in the <a href="relationships-between-two-variables.html#relationships-between-two-variables">Relationships between two variables</a> chapter we will reorder the levels of the <code>type</code> variable so that they get increasingly fierce.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 1. make a vector of storm type names in the required order</span>
storm_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Tropical Depression&quot;</span>, <span class="st">&quot;Extratropical&quot;</span>, <span class="st">&quot;Tropical Storm&quot;</span>, <span class="st">&quot;Hurricane&quot;</span>)
<span class="co"># 2. now convert type to a factor</span>
storms_alter &lt;-<span class="st"> </span>
<span class="st">  </span>storms <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="kw">factor</span>(type, <span class="dt">levels =</span> storm_names)) </code></pre></div>
<div id="adding-error-bars" class="section level2">
<h2><span class="header-section-number">24.1</span> Adding error bars</h2>
<p>In the <a href="building-in-complexity.html#building-in-complexity">Building in Complexity</a> chapter we learnt how to make a bar chart showing the means of our data. However, we generally want to show how variable the data are as well as the central tendency (e.g. mean) of the data. To do this we can include error bars showing for example the standard deviation or standard error of the mean. We’ll demonstrate this using the storms data set again, by plotting the means and standard errors of wind speed for each storm type.</p>
<p>We start by calculating the means and standard deviations for each group.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">storms_sum &lt;-<span class="st"> </span>
<span class="st">  </span>storms_alter <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(type) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_wind =</span> <span class="kw">mean</span>(wind), <span class="dt">std =</span> <span class="kw">sd</span>(wind))
storms_sum</code></pre></div>
<pre><code>## # A tibble: 4 x 3
##                  type mean_wind       std
##                &lt;fctr&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 Tropical Depression  27.35867  3.520588
## 2       Extratropical  40.06068 13.246997
## 3      Tropical Storm  47.32181 11.092150
## 4           Hurricane  84.65960 18.790856</code></pre>
<p>We can now use this data frame to make the plot, using <code>geom_col</code> to plot the means and the unsurprisingly named <code>geom_errorbar</code> to add the error bars.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(storms_sum, <span class="kw">aes</span>(<span class="dt">x=</span>type, <span class="dt">y =</span> mean_wind)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Plot the means</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Add the error bars</span>
<span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean_wind <span class="op">-</span><span class="st"> </span>std, <span class="dt">ymax =</span> mean_wind <span class="op">+</span><span class="st"> </span>std), <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Flip the axes round to prevent labels overlapping</span>
<span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Use a more professional theme </span>
<span class="st">  </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">12</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Change the axes labels</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Storm Category&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mean Wind Speed (mph)&quot;</span>)</code></pre></div>
<p><img src="eda-for-bio_files/figure-html/unnamed-chunk-361-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The <code>ymin</code> and <code>ymax</code> arguments of the <code>geom_errorbar</code> function give the lower and upper limits of error bars. Here, we have plotted the mean +/- 1 standard deviation. Note that we can change the width of the error bars using the <code>width</code> argument. Also remember if you’re including error bars on a plot that you <strong>MUST</strong> specify in the figure legend what they show (e.g. standard deviation, standard error of the mean, 95% confidence intervals).</p>
</div>
<div id="adding-text-to-plots" class="section level2">
<h2><span class="header-section-number">24.2</span> Adding text to plots</h2>
<p>There may be some cases in which you want to add text to plots, for example to show the sample size for each group or to show which categories are significantly different from each other if you’ve performed a statistical test (we’ll come back to this at Level 2).</p>
<p>Here we’re going to add a label for each bar on our bar chart. To do this we start by adding the labels that we want to use to the data frame. For example, here we will calculate the mean (using the <code>mean</code> function) and the sample size (using the function <code>n</code>) for each group.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">storms_sum &lt;-<span class="st"> </span>
<span class="st">  </span>storms <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(type) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_wind =</span> <span class="kw">mean</span>(wind), <span class="dt">samp =</span> <span class="kw">n</span>())
storms_sum</code></pre></div>
<pre><code>## # A tibble: 4 x 3
##                  type mean_wind  samp
##                 &lt;chr&gt;     &lt;dbl&gt; &lt;int&gt;
## 1       Extratropical  40.06068   412
## 2           Hurricane  84.65960   896
## 3 Tropical Depression  27.35867   513
## 4      Tropical Storm  47.32181   926</code></pre>
<p>Then we can add the text showing the sample size to our plot using the function <code>geom_text</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(storms_sum, <span class="kw">aes</span>(<span class="dt">x =</span> type, <span class="dt">y =</span> mean_wind)) <span class="op">+</span>
<span class="st"> </span><span class="co"># Add the bars</span>
<span class="st"> </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span>
<span class="st"> </span><span class="co"># Flip the axes round</span>
<span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span>
<span class="st"> </span><span class="co"># Change the axes labels</span>
<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Storm Category&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mean Wind Speed (mph)&quot;</span>) <span class="op">+</span>
<span class="st"> </span><span class="co"># Add the text</span>
<span class="st"> </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> samp, <span class="dt">y =</span> <span class="dv">10</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st"> </span><span class="co"># Use a more professional theme</span>
<span class="st"> </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">12</span>)</code></pre></div>
<p><img src="eda-for-bio_files/figure-html/unnamed-chunk-363-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="customising-text" class="section level2">
<h2><span class="header-section-number">24.3</span> Customising text</h2>
<p>Sometimes we may want to change the appearance of the text on the plot. For example, sometimes if the axis labels are quite long they may be bunched together or overlap each other, making it difficult to read them. We saw this before in the <a href="exploring-categorical-variables.html#exploring-categorical-variables">Exploring Categorical Variables</a> chapter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(storms_alter, <span class="kw">aes</span>(<span class="dt">x =</span> type)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">width =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Storm Type&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Number of Observations&quot;</span>)</code></pre></div>
<p><img src="eda-for-bio_files/figure-html/unnamed-chunk-364-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Here it is very difficult to read the categories on the <span class="math inline">\(x\)</span> axis as the text is overlapping. In the <a href="exploring-categorical-variables.html#exploring-categorical-variables">Exploring Categorical Variables</a> chapter we saw one way to deal with this, by using <code>coord_flip</code> to rotate the axes. An alternative to this is to change the size of text - a simple way to do this is to use the <code>base_size</code> argument within a ggplot <code>theme_XX</code> function as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(storms, <span class="kw">aes</span>(<span class="dt">x =</span> type)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">width =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Storm Type&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Number of Observations&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">10</span>)</code></pre></div>
<p><img src="eda-for-bio_files/figure-html/unnamed-chunk-365-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>The <code>base_size</code> argument changes the size of all of the text within the plot.</p>
<p>It is also possible to rotate the labels themselves rather than the whole plot. Here, we use the <code>angle</code> argument of the <code>element_text</code> function again inside <code>theme</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(storms, <span class="kw">aes</span>(<span class="dt">x =</span> type)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">width =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Storm Type&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Number of Observations&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>))</code></pre></div>
<p><img src="eda-for-bio_files/figure-html/unnamed-chunk-366-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>Here we used the argument ‘axis.text.x’ so that only the labels on the <span class="math inline">\(x\)</span> axis were rotated.</p>
</div>
<div id="saving-plots" class="section level2">
<h2><span class="header-section-number">24.4</span> Saving plots</h2>
<p>When using RStudio plots can be saved using the <code>Export</code> button. However, such plots are often pixelated. R also has a range of functions that can be used to save plots. When making figures with <code>ggplot</code> we can use the <code>ggsave</code> function.</p>
<p>For example, here we will create a scatter plot using the <code>storms</code> data set again.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(storms, <span class="kw">aes</span>(<span class="dt">x =</span> pressure, <span class="dt">y =</span> wind)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Add the points</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Change the axis labels</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Atmospheric pressure (mbar)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wind speed (mph)&quot;</span>)</code></pre></div>
<p><img src="eda-for-bio_files/figure-html/unnamed-chunk-367-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Once you’re happy with the plot you can use the <code>ggsave</code> function to save it as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">&quot;Stormsplot.pdf&quot;</span>, <span class="dt">height =</span> <span class="dv">5</span>, <span class="dt">width =</span> <span class="dv">5</span>)</code></pre></div>
<p>The first argument that this function takes is the name of the file that you will save. By default <code>ggsave</code> will save the last plot that you’ve made. You can also provide the name of a plot as the second argument to the function if you have assigned it a name. Note that R will save the plot to your working directory (you can change where the plot is saved to using the <code>path</code> argument in the <code>ggsave</code> function). Note that if you do not specify the <code>width</code> and <code>height</code> arguments to <code>ggsave</code> it will use the current size of your plotting window.</p>
<p>You can also add the <code>ggsave</code> function on to the code for a specific plot</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(storms, <span class="kw">aes</span>(<span class="dt">x =</span> pressure, <span class="dt">y =</span> wind)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Add the points</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Change the axis labels</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Atmospheric pressure (mbar)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wind speed (mph)&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Save the figure</span>
<span class="st">  </span><span class="kw">ggsave</span>(<span class="st">&quot;Stormsplot.pdf&quot;</span>, <span class="dt">height =</span> <span class="dv">5</span>, <span class="dt">width =</span> <span class="dv">5</span>)</code></pre></div>
</div>
<div id="panel-plots" class="section level2">
<h2><span class="header-section-number">24.5</span> Panel plots</h2>
<p>We have already seen how the <code>facet_wrap</code> function can be used to produce multiple panels in the <a href="introduction-to-ggplot2.html#introduction-to-ggplot2">Introduction to <strong>ggplot2</strong></a> chapter. This function can be used where you want to make multiple plots each showing a different level of a factor. However, sometimes you may wish to present a multi-panel plot using different variables in the different panels.</p>
<p>There are multiple ways to do this, we’re going to show you one using the <strong>cowplot</strong> package. First make sure that this package is installed (if you haven’t used it before) and loaded (every time you use it). Then make the individual plots that you want to include your multi-panel plot using <code>ggplot</code> as normal. For example we might want to look at a) the relative frequency of different storm types occuring and b) the mean wind speed associated with each storm type. First we make these two plots that we want to include in the panel and assign these to names.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plta &lt;-<span class="st"> </span><span class="kw">ggplot</span>(storms, <span class="kw">aes</span>(<span class="dt">x =</span> type)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Storm Type&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Number of Observations&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">10</span>) 

pltb &lt;-<span class="st"> </span><span class="kw">ggplot</span>(storms_sum, <span class="kw">aes</span>(<span class="dt">x=</span>type, <span class="dt">y =</span> mean_wind)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Plot the means</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Change the axes labels</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Storm Category&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mean Wind Speed (mph)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>(<span class="dt">base_size =</span> <span class="dv">10</span>)</code></pre></div>
<p>Then we can use the <code>plot_grid</code> function from the <strong>cowplot</strong> package to create the multi-panel plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_grid</span>(plta, pltb, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;auto&quot;</span>), <span class="dt">label_size =</span> <span class="dv">10</span>)</code></pre></div>
<p><img src="eda-for-bio_files/figure-html/unnamed-chunk-371-1.png" width="816" style="display: block; margin: auto;" /></p>
<p>The <code>plot_grid</code> function allows the panel to be customised easily, for example by changing the number of plots in each row (<code>nrow</code> argument) and including labels for each panel (<code>labels</code> argument).</p>
<p>We can then use the <code>ggsave</code> function to save our multi-panel plot as before.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create the multi-panel plot</span>
<span class="kw">plot_grid</span>(plta, pltb, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;auto&quot;</span>), <span class="dt">label_size =</span> <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co"># Save it</span>
<span class="st">  </span><span class="kw">ggsave</span>(<span class="st">&quot;Stormsplot.pdf&quot;</span>, <span class="dt">height =</span> <span class="dv">4</span>, <span class="dt">width =</span> <span class="dv">8</span>)</code></pre></div>

</div>
</div>

















            </section>

          </div>
        </div>
      </div>
<a href="building-in-complexity.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dzchilds/eda-for-bio/edit/master/3_08_ggplot_doingmore.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
},
"split_by": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
